<div class="player-bar">
  <!-- Controles de reproducción -->
  <div class="player-controls">
    <button class="control-btn" (click)="previousTrack()">
      <span class="material-icons">skip_previous</span>
    </button>
    <button class="control-btn play-btn" (click)="togglePlay()">
      <span class="material-icons">{{ isPlaying() ? 'pause' : 'play_arrow' }}</span>
    </button>
    <button class="control-btn" (click)="nextTrack()">
      <span class="material-icons">skip_next</span>
    </button>
  </div>
  
  <!-- Barra de progreso -->
  <div class="progress-section">
    <span class="time">{{ formattedCurrentTime() }}</span>
    <input 
      type="range" 
      class="progress-bar"
      [min]="0" 
      [max]="duration()" 
      [value]="currentTime()"
      (input)="seek($event)"
    >
    <span class="time">{{ formattedDuration() }}</span>
  </div>
  
  <!-- Radio Mode -->
  <div class="radio-control">
    <button 
      class="radio-btn" 
      [class.active]="radioEnabled()"
      [class.generating]="radioGenerating()"
      [title]="radioEnabled() ? 'Radio Mode ON - Click to configure' : 'Enable Radio Mode'"
      (click)="toggleRadioMode()"
      (contextmenu)="onOpenRadioSettings($event); $event.preventDefault()"
    >
      @if (radioGenerating()) {
        <span class="material-icons spinning">sync</span>
      } @else {
        <span class="material-icons">{{ radioEnabled() ? 'radio' : 'radio_button_unchecked' }}</span>
      }
      @if (radioEnabled()) {
        <span class="live-indicator">LIVE</span>
      }
    </button>
  </div>
  
  <!-- Play Mode -->
  <div class="play-mode-control">
    <button 
      class="mode-btn" 
      [class.active]="playMode() !== 'sequential'"
      [title]="getPlayModeLabel()"
      (click)="togglePlayModeMenu($event)"
    >
      <span class="material-icons">{{ getPlayModeIcon() }}</span>
    </button>
    
    @if (showPlayModeMenu()) {
      <div class="play-mode-menu">
        <div class="menu-section-title">Orden de reproducción</div>
        
        <button 
          class="menu-item" 
          [class.selected]="playMode() === 'sequential'"
          (click)="selectPlayMode('sequential')"
        >
          <span class="material-icons">repeat</span>
          <span class="label">En orden</span>
        </button>
        
        <button 
          class="menu-item" 
          [class.selected]="playMode() === 'shuffle'"
          (click)="selectPlayMode('shuffle')"
        >
          <span class="material-icons">shuffle</span>
          <span class="label">Aleatorio</span>
        </button>
        
        <div class="menu-divider"></div>
        <div class="menu-section-title">Filtrar por ranking</div>
        
        <button 
          class="menu-item" 
          [class.selected]="playMode() === 'by-ranking'"
          (click)="selectPlayMode('by-ranking')"
        >
          <span class="material-icons">emoji_events</span>
          <span class="label">Solo rankeadas</span>
        </button>
        
        <div class="menu-top-items">
          <button 
            class="menu-item top-btn" 
            [class.selected]="playMode() === 'top-50'"
            (click)="selectPlayMode('top-50')"
          >
            <span class="label">Top 50</span>
          </button>
          <button 
            class="menu-item top-btn" 
            [class.selected]="playMode() === 'top-100'"
            (click)="selectPlayMode('top-100')"
          >
            <span class="label">Top 100</span>
          </button>
          <button 
            class="menu-item top-btn" 
            [class.selected]="playMode() === 'top-200'"
            (click)="selectPlayMode('top-200')"
          >
            <span class="label">Top 200</span>
          </button>
          <button 
            class="menu-item top-btn" 
            [class.selected]="playMode() === 'top-300'"
            (click)="selectPlayMode('top-300')"
          >
            <span class="label">Top 300</span>
          </button>
          <button 
            class="menu-item top-btn" 
            [class.selected]="playMode() === 'top-400'"
            (click)="selectPlayMode('top-400')"
          >
            <span class="label">Top 400</span>
          </button>
          <button 
            class="menu-item top-btn" 
            [class.selected]="playMode() === 'top-500'"
            (click)="selectPlayMode('top-500')"
          >
            <span class="label">Top 500</span>
          </button>
        </div>
        
        <button 
          class="menu-item" 
          [class.selected]="playMode() === 'unranked'"
          (click)="selectPlayMode('unranked')"
        >
          <span class="material-icons">explore</span>
          <span class="label">Sin rankear (descubrir)</span>
        </button>
        
        <div class="menu-divider"></div>
        <div class="menu-section-title">Ordenar por</div>
        
        <button 
          class="menu-item" 
          [class.selected]="playMode() === 'by-artist'"
          (click)="selectPlayMode('by-artist')"
        >
          <span class="material-icons">person</span>
          <span class="label">Por Artista A-Z</span>
        </button>
        
        <button 
          class="menu-item" 
          [class.selected]="playMode() === 'by-genre'"
          (click)="selectPlayMode('by-genre')"
        >
          <span class="material-icons">category</span>
          <span class="label">Por Género A-Z</span>
        </button>
        
        <div class="menu-divider"></div>
        
        <button 
          class="menu-item disabled" 
          [class.selected]="playMode() === 'ai-suggested'"
          disabled
          title="Próximamente"
        >
          <span class="material-icons">psychology</span>
          <span class="label">IA Sugerido</span>
          <span class="badge">Próx.</span>
        </button>
        
        <div class="menu-divider"></div>
        <div class="menu-section-title">Opciones</div>
        
        <button 
          class="menu-item" 
          [class.active]="isReversed()"
          (click)="toggleReverse($event)"
        >
          <span class="material-icons">swap_vert</span>
          <span class="label">Invertir orden</span>
          @if (isReversed()) {
            <span class="material-icons check">check</span>
          }
        </button>
      </div>
    }
  </div>
  
  <!-- Volumen -->
  <div class="volume-control">
    <button class="volume-btn">
      <span class="material-icons">
        {{ volume() === 0 ? 'volume_off' : volume() < 50 ? 'volume_down' : 'volume_up' }}
      </span>
    </button>
    <div class="volume-popup">
      <div class="volume-track" (mousedown)="onVolumeTrackMouseDown($event)">
        <div class="volume-fill" [style.height.%]="volume()"></div>
      </div>
      <span class="volume-value">{{ volume() }}%</span>
    </div>
  </div>
  
  <!-- Settings -->
  <button class="settings-btn" title="Settings" (click)="onOpenSettings()">
    <span class="material-icons">settings</span>
  </button>
</div>
